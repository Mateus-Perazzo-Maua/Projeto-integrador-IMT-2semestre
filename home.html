<!DOCTYPE html>
<html lang="pt-br">

<head>
  <script src="https://cdn.userway.org/widget.js" data-account="aOJQyEvZG8"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home - GerAI Poliedro</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <button class="menu-toggle" id="menuToggle">‚ò∞</button>

  <div class="d-flex" id="app-container">
    <!-- barra lateral -->
    <aside class="sidebar d-flex flex-column p-3 text-white">
      <a href="home.html" class="d-flex align-items-center mb-4 text-white text-decoration-none sidebar-logo">
        <i class="bi bi-magic fs-3 me-2"></i>
        <span class="fs-4 fw-semibold">GerAI Poliedro</span>
      </a>
      <ul class="nav nav-pills flex-column mb-auto">
        <li><a href="home.html" class="nav-link active"><i class="bi bi-house-door me-2"></i>Home</a></li>
        <li><a href="tela-gerar.html" class="nav-link"><i class="bi bi-stars me-2"></i>Gerar Imagem</a></li>
        <li><a href="historico.html" class="nav-link"><i class="bi bi-archive me-2"></i>Hist√≥rico</a></li>
      </ul>
      <div class="mt-auto">
        <button id="logoutBtn" class="btn btn-gradient w-100 mt-4">
          <i class="bi bi-box-arrow-right me-2"></i>Logout
        </button>
      </div>
    </aside>

    <!-- conte√∫do -->
    <main class="content flex-fill p-5 text-center">
      <div class="welcome-box shadow-sm">
        <h2 class="mb-3 fw-semibold">üëã Bem-vindo ao <span class="text-gradient">GerAI Poliedro</span></h2>
        <p class="text-muted">Use a barra lateral para navegar e crie imagens incr√≠veis.</p>
        <div class="mt-4">
          <img src="https://picsum.photos/900/300" class="img-fluid rounded-4 shadow-lg" alt="exemplo">
        </div>
      </div>

      <!-- estat√≠sticas -->
      <section class="stats-section mt-5">
        <h3 class="fw-semibold mb-4 text-start text-gradient">üìä Estat√≠sticas Recentes</h3>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="stat-card shadow-sm">
              <i class="bi bi-image text-primary fs-3 mb-2"></i>
              <h4 id="total-imagens">48</h4>
              <p>Imagens Geradas</p>
            </div>            
          </div>
          <div class="col-md-4">
            <div class="stat-card shadow-sm">
              <i class="bi bi-clock-history text-info fs-3 mb-2"></i>
              <h4>12s</h4>
              <p>Tempo M√©dio</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="stat-card shadow-sm">
              <i class="bi bi-lightbulb text-success fs-3 mb-2"></i>
              <h4>‚ÄúQu√≠mica‚Äù</h4>
              <p>Tema Popular</p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
  <script>
    async function atualizarEstatisticas() {
      try {
        const email = localStorage.getItem("email"); // pega o email do login
        if (!email) return; // se n√£o estiver logado, sai
  
        const response = await fetch("http://localhost:3000/api/history", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });
  
        const data = await response.json();
  
        if (data.success) {
          const totalImagens = data.history.length;
          const estatisticaImagens = document.getElementById("total-imagens");
          estatisticaImagens.textContent = totalImagens;
  
          console.log(`Imagens geradas: ${totalImagens}`);
        }
      } catch (error) {
        console.error("Erro ao atualizar estat√≠sticas:", error);
      }
    }
  
    // Atualiza ao carregar a p√°gina
    document.addEventListener("DOMContentLoaded", atualizarEstatisticas);
  </script>  
</body>

</html>